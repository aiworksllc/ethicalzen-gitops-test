apiVersion: ethicalzen.ai/v1
kind: Guardrail
metadata:
  name: pii_blocker
  version: v1.0.0
  description: "Detects and blocks PII (SSN, email, phone, credit card)"
  owner: security-team@acme.com
  domain: general
  regulations:
    - HIPAA
    - GDPR
    - CCPA
  labels:
    environment: production
    team: platform-security
  applicable_industries:
    - healthcare
    - finance
    - insurance
  failure_modes_addressed:
    - pii_leak
    - data_breach
  severity: critical
spec:
  type: regex
  action_on_violation: block
  patterns:
    - name: ssn
      pattern: "\\b\\d{3}-\\d{2}-\\d{4}\\b"
      weight: 1.0
      category: high_risk
    - name: email
      pattern: "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"
      weight: 0.8
      category: medium_risk
    - name: phone
      pattern: "\\b\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}\\b"
      weight: 0.6
      category: medium_risk
    - name: credit_card
      pattern: "\\b(?:\\d{4}[- ]?){3}\\d{4}\\b"
      weight: 1.0
      category: high_risk
  thresholds:
    block: 0.4
    warn: 0.3
    pass: 0.7
calibration:
  sampleSize: 100
  accuracy: 0.97
  precision: 0.95
  recall: 0.98
  f1Score: 0.965
  calibratedAt: "2026-02-01T00:00:00Z"
  thresholdTuned: 0.4
evaluation:
  endpoint: http://localhost:3001/evaluate
  provider: local
