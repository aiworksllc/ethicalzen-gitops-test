apiVersion: ethicalzen.ai/v1
kind: Guardrail
metadata:
  name: log_retrieval_detector
  version: v2.0.0
  description: "Detects attempts to retrieve internal logs or memory, such as embeddings, chain-of-thought, intermediate validation outputs, or stored patient packets"
  owner: demo-tenant@ethicalzen.ai
  domain: general
  severity: medium
spec:
  type: regex
  action_on_violation: block
  patterns:
    - name: pattern_0
      pattern: "\b(log|memory|embedding|chain-of-thought|validation output|patient packet)\b"
      weight: 1.0
    - name: pattern_1
      pattern: "\b(retrieve|access|show)\b"
      weight: 1.0
  thresholds:
    block: 0.5
    warn: 0.3
    pass: 0.8
