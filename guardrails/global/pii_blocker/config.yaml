apiVersion: ethicalzen.ai/v1
kind: Guardrail
metadata:
  name: pii_blocker
  version: v1.0.0
  description: "Detects and blocks Personally Identifiable Information (SSN, email, phone, credit card, DOB, IP)"
  owner: security-team@acme.com
  domain: general
  regulations:
    - HIPAA
    - GDPR
    - CCPA
    - SOC2
    - PCI-DSS
  labels:
    environment: production
    team: platform-security
  applicable_industries:
    - healthcare
    - finance
    - insurance
    - legal
    - general
  failure_modes_addressed:
    - pii_leak
    - data_breach
    - privacy_violation
    - unauthorized_disclosure
  severity: critical
spec:
  type: regex
  action_on_violation: block
  envelope:
    constraints:
      pii_risk:
        min: 0.0
        max: 0.1
        action: block
  runtime:
    timeout_ms: 100
    cache_ttl: 0
    fail_open: false
  patterns:
    - name: ssn
      pattern: "\\b\\d{3}-\\d{2}-\\d{4}\\b"
      weight: 1.0
      category: high_risk
    - name: email
      pattern: "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"
      weight: 0.8
      category: medium_risk
    - name: phone
      pattern: "\\b\\(?(\\d{3})\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}\\b"
      weight: 0.6
      category: medium_risk
    - name: credit_card
      pattern: "\\b(?:\\d{4}[- ]?){3}\\d{4}\\b"
      weight: 1.0
      category: high_risk
calibration:
  method: regex_pattern_matching
  thresholds:
    tAllow: 0.3
    tBlock: 0.4
  weights:
    high_risk: 0.4
    medium_risk: 0.15
  validationStats:
    accuracy: 0.97
    precision: 0.95
    recall: 0.98
    f1: 0.965
    datasetSize: 100
evaluation:
  language: javascript
  file: index.js
